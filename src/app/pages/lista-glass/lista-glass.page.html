<ion-header>
  <app-clasic-toolbar [ruta]="'/repuestos'" [title]="'Lista de glass'"></app-clasic-toolbar>
</ion-header>


<ion-content *ngIf="glasses">
  <app-precio-dolar [loggedUser]="loggedUser"
    *ngIf="loggedUser && funcionesUtiles.roleMinimoNecesario('OWNER',loggedUser)"></app-precio-dolar>

  <ion-item>
    <ion-select aria-label="Fruit" placeholder="Selecciona los campos que quieres ver" [multiple]="true"
      [(ngModel)]="camposSeleccionados">
      <ion-select-option value="marca">Marca</ion-select-option>
      <ion-select-option value="modelo">Modelo</ion-select-option>
      <ion-select-option value="precio">Precio</ion-select-option>
      <ion-select-option value="stock">Cantidad</ion-select-option>
    </ion-select>
  </ion-item>

  <ion-searchbar show-clear-button="focus" placeholder="J7 prime" (ionInput)="handleInput($event)"></ion-searchbar>

  <ion-grid class="ion-text-center">
    <ion-row>
      <ion-col *ngIf="camposSeleccionados.includes('marca')"><b>Marca</b></ion-col>
      <ion-col *ngIf="camposSeleccionados.includes('modelo')"><b>Modelo</b></ion-col>
      <ion-col *ngIf="camposSeleccionados.includes('precio')"><b>Precio</b></ion-col>
      <ion-col *ngIf="camposSeleccionados.includes('stock')"><b>Cantidad</b></ion-col>
    </ion-row>
    <ion-row *ngFor="let glass of glassesAMostrar"
      (click)=" funcionesUtiles.roleMinimoNecesario('ADMIN',loggedUser)?seleccionar(glass):''"
      >
      <ion-col *ngIf="camposSeleccionados.includes('marca')">{{glass.marca|titlecase}}</ion-col>
      <ion-col *ngIf="camposSeleccionados.includes('modelo')">{{glass.modelo|titlecase}}</ion-col>
      <ion-col *ngIf="camposSeleccionados.includes('precio')">
        {{(glass.precio*precioDolarBlue)|currency:'USD':'symbol':'1.0-0' }}</ion-col>
      <ion-col *ngIf="camposSeleccionados.includes('stock')" (click)="funcionesUtiles.roleMinimoNecesario('ADMIN',loggedUser)?mostrarEditorStockRapido($event,glass):''">
        <ion-text [color]="glass.stock<1
        ?'danger'
        :(glass.stock>=1&&glass.stock<3)
        ?'warning':''">{{glass.stock}}</ion-text>
      </ion-col>
    </ion-row>
  </ion-grid>


  <ion-fab *ngIf="funcionesUtiles.roleMinimoNecesario('ADMIN',loggedUser)" slot="fixed" vertical="bottom"
    horizontal="end" (click)="abrirFormGlass()">
    <ion-fab-button>
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>

  </ion-fab>

</ion-content>
<!-- FORM MODIFICAR STOCK RAPIDO -->
<div *ngIf="showStockDialog" (click)="this.showStockDialog = false;" class="flexCenterCenter customModal">
  <ion-card (click)="$event.stopPropagation();">
    <ion-card-header>

      <ion-item-divider class="ion-padding">
        <ion-chip class="ion-text-center" slot="start" color="danger" outline="true"
          (click)="cambiarCantidad('disminuir')">
          <ion-icon class="ion-no-margin" name="remove-outline"></ion-icon>
        </ion-chip>

        <ion-card class="ion-padding">
          {{this.modeloSeleccionadoEditable.stock}}
        </ion-card>

        <ion-chip class="ion-text-center" slot="end" color="success" outline="true"
          (click)="cambiarCantidad('aumentar')">
          <ion-icon class="ion-no-margin" name="add-outline"></ion-icon>
        </ion-chip>
      </ion-item-divider>
    </ion-card-header>
    <ion-card-content>
      <ion-button expand="block" class="ion-margin" color="primary" (click)="guardarCambios()">Guardar
        cambios</ion-button>
    </ion-card-content>
  </ion-card>
</div>
<!-- FIN FORM MODIFICAR STOCK RAPIDO -->